#include <iostream>

#include "Sofer.h"

#include "Masina.h"
#include "Motocicleta.h"
#include "Camion.h"

#include "LocParcare.h"
#include "LocParcareElectric.h"
#include "LocParcareCamion.h"
#include "LocParcareMotocicleta.h"
#include "LocParcareHandicap.h"

#include "Tichet.h"
#include "PoliticaPret.h"
#include "PretZi.h"
#include <thread>

int main() {
    std::cout << "===== DIMENSIUNI STANDARD LOCURI =====\n";

    Dimensiune dimLocMasina = Dimensiune::pentruLocMasina();
    Dimensiune dimLocMoto   = Dimensiune::pentruLocMoto();
    Dimensiune dimLocCamion = Dimensiune::pentruLocCamion();

    // =========================
    // VEHICULE
    // =========================
    Vehicul* masinaElectrica = new Masina(
        1,
        "B123ELC",
        {4.2, 1.9, 1.6},
        1600.0,
        4,
        "electric",
        true
    );

    Vehicul* masinaNormala = new Masina(
        2,
        "B124GAS",
        {4.2, 1.9, 1.6},
        1400.0,
        4,
        "benzina",
        false
    );

    Vehicul* motocicleta = new Motocicleta(
        3,
        "B456MOTO",
        {2.3, 0.9, 1.2},
        300.0,
        600,
        false
    );

    Vehicul* camion = new Camion(
        4,
        "B999TRK",
        {8.5, 2.6, 3.8},
        9500.0,
        20000.0,
        4
    );

    // =========================
    // LOCURI DE PARCARE
    // =========================
    LocParcare locSimplu(10);
    LocParcareElectric locElectric(20, 1200.0, "Type2");
    LocParcareCamion locCamion(30,30000.0, 4);
    LocParcareMotocicleta locMoto(40, 5);

    // =========================
    // TEST INCAPERE (dimensiune)
    // =========================
    std::cout << "\n===== TEST INCAPERE =====\n";

    std::cout << "Motocicleta incape loc moto: "
              << locMoto.incapeVehicul(*motocicleta) << "\n";

    std::cout << "Masina incape loc moto: "
              << locMoto.incapeVehicul(*masinaElectrica) << "\n";

    std::cout << "Camion incape loc moto: "
              << locMoto.incapeVehicul(*camion) << "\n";

    // =========================
    // TEST ACCEPTARE (reguli)
    // =========================
    std::cout << "\n===== TEST ACCEPTARE =====\n";

    std::cout << "Motocicleta acceptata loc moto: "
              << locMoto.acceptaVehicul(*motocicleta) << "\n";

    std::cout << "Masina acceptata loc moto: "
              << locMoto.acceptaVehicul(*masinaElectrica) << "\n";

    std::cout << "Camion acceptat loc moto: "
              << locMoto.acceptaVehicul(*camion) << "\n";

    std::cout << "\nMasina electrica acceptata loc electric: "
              << locElectric.acceptaVehicul(*masinaElectrica) << "\n";

    std::cout << "Masina normala acceptata loc electric: "
              << locElectric.acceptaVehicul(*masinaNormala) << "\n";

    std::cout << "Camion acceptat loc camion: "
              << locCamion.acceptaVehicul(*camion) << "\n";

    // =========================
    // TEST OCUPARE
    // =========================
    std::cout << "\n===== TEST OCUPARE =====\n";

    std::cout << "Loc moto ocupat? "
              << locMoto.esteOcupat() << "\n";

    locMoto.ocupa();

    std::cout << "Loc moto ocupat dupa ocupa()? "
              << locMoto.esteOcupat() << "\n";

    locMoto.elibereaza();

    std::cout << "Loc moto ocupat dupa elibereaza()? "
              << locMoto.esteOcupat() << "\n";

    // =========================
    // CLEANUP
    // =========================
    delete masinaElectrica;
    delete masinaNormala;
    delete motocicleta;
    delete camion;

    Sofer tibi(2,"tibi",1); 
    LocParcareHandicap locH(1,2.56,1);

    std::cout << locH.acceptaSofer(tibi);
    
    Tichet t(1);
    
    std::this_thread::sleep_for(std::chrono::seconds(60));
    t.seteazaOraIesire();
    t.inchide();
    PretZi tarif;
    std::cout << "tarif: " << tarif.calculeazaPret(t) << "\n";
    t.seteazaSuma(tarif.calculeazaPret(t));
    std::cout << "suma: " << t.obtineSuma();
    std::cout << "\n===== TEST FINALIZAT CU SUCCES =====\n";
    return 0;
}

